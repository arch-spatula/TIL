# 블로그 다시 만들기 86일차

1일1커밋 무사고: 1017일차

## 감사일기

1. ???

## todo

- [ ] 운동
  - [ ] 클라이밍
    - [ ] 09월 28일
  - [ ] 헬스
  - [ ] 자전거
- [ ] Do it C++ 코딩 테스트
  - [ ] C++ nvim DAP에 표준입력이 가능하게 설정해보기
  - [ ] 2일차
    - 읽다가 사이드 퀘스트가 생겼습니다.
- [ ] 마이크로 튜토리얼
  - [ ] Chapter 4 - Request Lines
  - [ ] Chapter 5 - HTTP Headers
  - [ ] Chapter 6 - HTTP Body
  - [ ] Chapter 7 - HTTP Responses
  - [ ] Chapter 8 - Chunked Encoding
  - [ ] Chapter 9 - Binary Data
- [ ] 블로그 다시 만들기 전 실험
  - [ ] vite로 github pages가 정적 리소스 응답하는 방식 흉내내기
  - [ ] ToC
    - [ ] `data.json`에 h1 ~ h6에 해당하는 데이터 추가
    - [ ] DOM에 붙이기
  - [ ] 검색 팝업에서 tag 클랙해도 input 상태 보존하기

---

## C++ nvim DAP에 표준입력이 가능하게 설정해보기

- 이 내용은 3일 이상 다루었습니다. 에러 로그의 형식으로 다루어볼 가치가 있는 것 같습니다.

### 문제: CLI를 많이 만들 것인데 디버거로 표준입력을 처리할 수 없으면 곤란함

- c++로 표준입력을 받아 디버거를 실행할 수 없습니다.
- 이것이 문제인 이유는 표준입력을 받는 커맨드라인 툴을 앞으로 많이 작성할 것인데 nvim에서 이것을 제어할 수 없으면 성장하는데 곤란하다고 보기 때문입니다.
  - 코드의 제어 흐름을 단순한 로그만으로 파악하지 않고 더 구체적으로 코드가 실행하는 줄마다 파악하는 과정을 갖고자 합니다.

### 시도 1: The perfect Neovim setup for C++

- The perfect Neovim setup for C++
- https://www.youtube.com/watch?v=lsFoZIg-oDs
- 원래는 위 튜토리얼을 활용해서 neovim에 DAP 설정을 했었습니다.
  - 이슈는 표준입력을 처리할 수 없다는 것입니다.
  - 그래서 검색하고 문서를 찾아보기 시작했습니다.
  - mason에서 설치해주는 디버거는 vscode-lldb였습니다.
  - https://codeberg.org/mfussenegger/nvim-dap/wiki/Debug-Adapter-installation
  - 위 문서를 발견했습니다.
  - `NOTE: recomended for dap ui users`이라는 문구를 발견하고 gdb via vscode-cpptools을 적용하고자 합니다.
- yama/ptrace_scope에 대해서 설명을 찾아보니 보안이 취약해진다는 점을 발견했습니다. 이 부분이 마음에 안 들어서 lldb-vscode는 피하고자 합니다.
- gdb를 직접 실행하는 것도 결국에는 Yama를 프로세스에 붙여야 합니다. 이점도 결국 제가 기각하게 만들 이유가 되었습니다.

### 시도 2: codelldb 적용

- 첫단계는 설치입니다.
  - 저는 설치 명령을 기대했는데 다음 명령들을 시도 해봤습니다.

#### lldb의 버전 확인하기

```sh
lldb --version
```

- 예전에 명령했을 때는 아무 결과도 안 나왔었습니다.

```sh
lldb-1.2.3.4
Apple Swift version 1.2 (swiftlang-1.2.3.4 clang-1.2.3.4)
```

- 대략 위랑 비슷합니다. 버전은 일부러 숨기기 위해 바꿨습니다.
- 일단 저의 노트북 하드웨어에 이미 lldb가 설치되어 있습니다.
- Swift와 함께 번들된 Clang(LLVM C/Objective-C/C++) 컴파일러 빌드 번호라고 말합니다.
  - 애플 내에서 자체적으로 정한 버전이라고 봐야할 것 같습니다.
- https://lldb.llvm.org/
  - 위 문서의 설명을 보면 llvm을 기반으로 만들어졌다고 합니다.
  - macos의 기본 디버거라고 합니다. 저는 이 lldb의 경로만 알고 DAP 올바른 설정만 하면 디버거를 활용할 수 있을 것 같습니다.

```sh
brew install llvm
```

- 일단 llvm을 설치했습니다.

```sh
/opt/homebrew/opt/llvm/bin/lldb --version
```

- 위 명령으로 llvm 버전을 알 수 있습니다.

```sh
echo 'export PATH="/opt/homebrew/opt/llvm/bin:$PATH"' >> ~/.zshrc
source ~/.zshrc
```

- 위 명령으로 `llvm`이 `zsh`에 연결이 되어야 하는데 안 되고 있습니다.

##### llvm이 zsh에 설정이 안 되고 있음

```sh
echo 'alias llvm="llvm-config"' >> ~/.zshrc
source ~/.zshrc
```

- 위 명령으로 해결 되었습니다. llvm은 툴체인이 거대하고 많기 때문에 정확히 무엇을 연결해야 하는지 애매할 수 있습니다.

```sh
llvm --version
```

- 이제 정확한 버전을 출력할 것입니다.

```sh
lldb --version
```

- 이렇게 하면 lldb의 정확한 버전을 알 수 있게 됩니다.
- 이제는 lldb가 설치 된 것도 알고 버전도 알게 되었습니다.
- https://codeberg.org/mfussenegger/nvim-dap/wiki/C-C---Rust-(via--codelldb)

#### ???

> Unpack it. .vsix is a zip file and you can use unzip to extract the contents.

- 위 설명을 주의해야하는지 잘 모르겠습니다. vscode 플러그인을 위해 압축을 풀어야 하는 문제로 생각 됩니다.
- vscode에 사람들이 많이 설치해서 플러그인 설치를 해야 디버거를 적용할 수 있는 것 같습니다.
  - 저의 경우 nvim으로 설치했기 때문에 아래 경로에 codelldb가 나올 것입니다.

```
~/.local/share/nvim/mason/packages/codelldb/extension/adapter/codelldb
```

- 공식문서에서 알려주는 설정은 다음과 같습니다.

```lua
local dap = require('dap')
dap.adapters.codelldb = {
  type = "executable",
  command = "codelldb", -- or if not in $PATH: "/absolute/path/to/codelldb"

  -- On windows you may have to uncomment this:
  -- detached = false,
}
dap.configurations.cpp = {
  {
    name = "Launch file",
    type = "codelldb",
    request = "launch",
    program = function()
      return vim.fn.input('Path to executable: ', vim.fn.getcwd() .. '/', 'file')
    end,
    cwd = '${workspaceFolder}',
    stopOnEntry = false,
  },
}
```

#### ???

- https://github.com/mfussenegger/nvim-dap/issues/1437
- 위 이슈를 발견했습니다. 아마 제가 연결해야 하는것은 lldb-dap인 것 같습니다.

### 시도 2: vscode-cpptools 적용

- ????

### 해결: ???

- ???

### 학습: ???

- https://www.kernel.org/doc/html/latest/admin-guide/LSM/Yama.html
  - 이런 문서가 있었습니다.
