# 블로그 다시 만들기 148일차

1일1커밋 무사고: 30일차

## 감사일기

1. ???

## todo

- [ ] ???

---

## yazi를 써보자

- https://www.youtube.com/watch?v=H9HCCMq4E94
- You've been browsing files wrong
- 터미널 파일 브라우져입니다.
  - 폴더 이동, 파일 이름 변경, 파일 선택 후 이동 등 지원합니다.
  - 폴더 검색을 지원합니다.
  - 파일 검색도 가능합니다.
- https://yazi-rs.github.io/
- https://github.com/sxyazi/yazi
- rust 언어로 작성 되어 있습니다.

```sh
brew update
```

- 업데이트를 처리합니다.

```sh
brew upgrade
```

- 패키지 최신화입니다.

```sh
brew install yazi ffmpeg sevenzip jq poppler fd ripgrep fzf zoxide resvg imagemagick font-symbols-only-nerd-font
```

- 위는 모든 의존성 설치인데 저는 최소한의 의존성만 먼저 설치하고 싶습니다.

```sh
brew install yazi
```

- 단순하게 파일 이동 정도가 목표인 저에게는 이정도 설치로 충분했습니다.

## localhost과 127.0.0.1의 차이는 무엇인가?

- 원인은 이전에 vite로 만들었던 개발자 블로그 실험용 프로젝트는 http://localhost:5173/ 주소에 파비콘이 보이는데 http://localhost:3000/ 으로 node.js로 만든 프로젝트에서는 안 보이는 문제가 있었습니다.
- 블로그를 찾아보니까 http://127.0.0.1:3000/ 으로 접근하면 보인다고 합니다.
- 여기서 의문이 생겼습니다. 둘이 무엇이 다른가?
- 결국 둘다 루프백 서버를 접근한다고 생각을 했습니다.

```ts
// 개발 환경에 적합한 캐시 헤더 설정
const headers: Record<string, string> = {
  "Content-Type": mimeType,
  // 캐시 무효화: 항상 최신 버전 확인
  "Cache-Control": "no-cache, no-store, must-revalidate",
  Pragma: "no-cache",
  Expires: "0",
};

// 응답
res.writeHead(200, headers);
```

- cursor로 질문해보니까 위 코드를 돌려주었습니다.
- 위는 해결책입니다. 하지만 더 생각해야 할 것은 문제입니다.
- 브라우저는 이 둘을 **다른 오리진(origin)**으로 취급합니다. 이부분이 중요한 힌트였습니다.
- `http://localhost:3000` → 독립적인 캐시
- `http://127.0.0.1:3000` → 별도의 독립적인 캐시
- 또 node.js는 기본적으로 캐싱을 오랫동안 갖도록 기본 값이 설정 되어 있다고 합니다.

### 각 헤더의 역할:

1. **`Cache-Control: no-cache, no-store, must-revalidate`**
   - `no-cache`: 매번 서버에 검증 요청
   - `no-store`: 캐시에 저장하지 않음
   - `must-revalidate`: 캐시가 만료되면 반드시 재검증

2. **`Pragma: no-cache`**
   - HTTP/1.0 호환성을 위한 구형 헤더

3. **`Expires: 0`**
   - 즉시 만료 (구형 브라우저 지원)

- 이렇다고 합니다.
- 실제 RFC 문서를 찾아보는 연습이 필요하지만 이 부분은 생략할 것입니다.

```ts
   // Vite는 이런 헤더를 자동으로 설정
   Cache-Control: no-cache
   ETag: "unique-hash"
```

- vite에서는 위처럼 처리한다고 하는데 이 부분도 소스코드를 직접 찾아보고 블로그 소재로 정리해야 할 것 같습니다.

| 측면              | localhost         | 127.0.0.1       |
| ----------------- | ----------------- | --------------- |
| **타입**          | 도메인 이름       | IP 주소         |
| **DNS 조회**      | 필요 (hosts 파일) | 불필요          |
| **브라우저 캐시** | 별도 캐시         | 별도 캐시       |
| **쿠키 도메인**   | 다름              | 다름            |
| **실제 위치**     | 같음 (loopback)   | 같음 (loopback) |

- 이런 현상으로 봤을 때 localhost는 캐싱되어서 반영이 안 되었고 127.0.0.1은 새롭게 캐싱을 해야하기 때문에 파비콘이 반영 된 것 같습니다.
